name: Bot Trigger

on:
  workflow_dispatch:  # –∑–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ API
    inputs:
      name:
        description: "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
        required: true
      email:
        description: "Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
        required: true
      rate:
        description: "–°—É–º–º–∞ (rate)"
        required: true
      data:
        description: "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è/–¥–æ—Å—Ç—É–ø–∞"
        required: true

jobs:
  add_user:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Add user
        run: |
          NAME="${{ github.event.inputs.name }}"
          EMAIL="${{ github.event.inputs.email }}"
          RATE="${{ github.event.inputs.rate }}"
          DATA="${{ github.event.inputs.data }}"

          # üîπ –†–∞—Å—Å—á–∏—Ç–∞–µ–º —Å—Ä–æ–∫ –¥–æ—Å—Ç—É–ø–∞
          if [ "$RATE" -eq 350 ]; then
            DAYS=30
          elif [ "$RATE" -eq 3000 ]; then
            DAYS=365
          else
            echo "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π rate: $RATE"
            exit 1
          fi

          EXPIRATION_DATE=$(date -d "$DATA +$DAYS days" +%Y-%m-%d)

          echo "–î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:"
          echo "–ò–º—è: $NAME"
          echo "Email: $EMAIL"
          echo "–°—É–º–º–∞: $RATE"
          echo "–î–∞—Ç–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–æ: $EXPIRATION_DATE"

          # üîπ –¢—É—Ç –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ API Tilda
          # node add_user.js "$NAME" "$EMAIL" "$EXPIRATION_DATE" "$RATE"
